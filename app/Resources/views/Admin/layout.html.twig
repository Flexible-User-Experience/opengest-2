{% extends "SonataAdminBundle::standard_layout.html.twig" %}

{# removes top search bar #}
{% block sonata_sidebar_search %}{% endblock %}

{# custom logo #}
{% block logo %}
    {% spaceless %}
        <a class="logo" href="{{ path('sonata_admin_dashboard') }}" style="background-color:#2c3b41;">
            <span style="color:#FFF;text-shadow: 0 1px 5px rgba(0, 0, 0, 0.95);">{{ admin_brand_title }}</span>
        </a>
    {% endspaceless %}
{% endblock %}

{# custom sidebar footer #}
{% block side_bar_after_nav %}
    <p class="text-left small" style="padding:50px 0 0 20px;color:#EEE;">
        {{ admin_tag_version }}<br><i class="fa fa-code"></i> Desenvolupat per <a href="https://www.flux.cat" target="_blank">Flux</a><br>
        <i class="fa fa-copyright"></i> {{ 'now' | date('Y') }} <a href="{{ path('front_homepage') }}" target="_blank">{{ main_brand_title | title }}</a>
    </p>
{% endblock %}

{# custom top menu #}
{% block sonata_top_nav_menu %}
    <div class="navbar-custom-menu">
        <ul class="nav navbar-nav navbar-right">
            {{ showUnreadMessages() | raw }}
            <div id="enterprise-logo">
                <div class="dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                    {% if app.user.defaultEnterprise.logo is not null %}
                        <img src="{{ vich_uploader_asset(app.user.defaultEnterprise, 'logoFile') | imagine_filter('140x40') }}" alt="{{ app.user.defaultEnterprise.name }}">
                    {% else %}
                        <img src="//via.placeholder.com/140x40?text={{ app.user.defaultEnterprise.name }}" alt="logo">
                    {% endif %}
                </div>
                <div class="dropdown-menu" aria-labelledby="dropdownMenu1" style="right:197px;">
                    {% for enterprise in app.user.enterprises %}
                        <li>
                            <a href="{{ path('admin_app_enterprise_enterprise_change', {id: enterprise.id}) }}">
                                {% if enterprise.logo is not null %}
                                    <img src="{{ vich_uploader_asset(enterprise, 'logoFile') | imagine_filter('140x40') }}" alt="{{ enterprise.name }}">
                                {% else %}
                                    <img src="//via.placeholder.com/140x40?text={{ enterprise.name }}" alt="logo">
                                {% endif %}
                            </a>
                        </li>
                    {% endfor %}
                </div>
            </div>
            <li class="user user-menu">
                <a href="{{ path('admin_app_setting_user_profile') }}">
                    {% if app.user.mainImage %}
                        <img src="{{ vich_uploader_asset(app.user, 'mainImageFile') | imagine_filter('25x25') }}" class="user-image" alt="profile image">
                    {% endif %}
                    <span class="hidden-xs">{{ app.user.naturalName }}</span>
                </a>
            </li>
            <li><a href="{{ path('front_homepage') }}"><i class="fa fa-globe"></i></a></li>
            <li><a href="{{ path('sonata_user_admin_security_logout') }}"><i class="fa fa-power-off text-success"></i></a></li>
        </ul>
    </div>
{% endblock %}

{# override css includes #}
{% block stylesheets %}
    {{ parent() }}
    {% stylesheets filter="cssrewrite,less" '@mybackendcss' %}
        <link rel="stylesheet" type="text/css" href="{{ asset_url }}"/>
    {% endstylesheets %}
{% endblock %}

{# override javascript includes #}
{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript" src="{{ asset('bundles/app/js/pdf.js') }}"></script>
    <script type="text/javascript" src="{{ asset('bundles/app/js/pdf.worker.js') }}"></script>
{% endblock %}
